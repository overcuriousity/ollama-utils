# Modelfile for deepseek-coder-v2-lite-instruct-q4_k_m
# hf_upstream: https://huggingface.co/bartowski/DeepSeek-Coder-V2-Lite-Instruct-GGUF/resolve/main/DeepSeek-Coder-V2-Lite-Instruct-Q4_K_M.gguf
# quantization: Q4_K_M
# capabilities: tools
# sha256: <add_sha256_checksum_here>

FROM ./DeepSeek-Coder-V2-Lite-Instruct-Q4_K_M.gguf

# System prompt - customize for your use case
SYSTEM """You are Deepseek-Coder-V2-Lite, A specialized Large Language model for coding, logic and math."""

# Parameters - refer to manufacturer's recommendations
# https://huggingface.co/bartowski/DeepSeek-Coder-V2-Lite-Instruct-GGUF
PARAMETER temperature 0.2
PARAMETER top_p 0.9

PARAMETER num_ctx 18432
PARAMETER num_predict 32768
PARAMETER repeat_penalty 1.0
PARAMETER stop "<|im_start|>"
PARAMETER stop "<|im_end|>"
PARAMETER stop "</s>"

# Template - adjust based on model's chat template
TEMPLATE """
{{- if .Suffix }}<｜fim▁begin｜>{{ .Prompt }}<｜fim▁hole｜>{{ .Suffix }}<｜fim▁end｜>
{{- else if .Messages }}<｜begin▁of▁sentence｜>
{{- $system := "" }}
{{- range $i, $_ := .Messages }}
{{- if eq .Role "system" }}
{{- $system = printf "%s %s" $system .Content }}
{{- else if eq .Role "user" }}
{{- if $system }}{{ $system }}
{{ $system = "" }}
{{ end }}User: {{ .Content }}

{{ if eq (len (slice $.Messages $i)) 1 }}Assistant:
{{- end }}
{{- else if eq .Role "assistant" }}Assistant: {{ .Content }}<｜end▁of▁sentence｜>
{{- end }}
{{- end }}
{{- else }}
{{- if .System }}{{ .System }}
{{- end }}
{{- if .Prompt }}User: {{ .Prompt }}
{{- end }}Assistant:{{ .Response }}
{{- end }}
"""